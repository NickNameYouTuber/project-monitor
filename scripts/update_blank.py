from pathlib import Path
from typing import Iterable

from docx import Document


def set_cell_lines(cell, lines: Iterable[str]) -> None:
    lines = list(lines)
    if not lines:
        cell.text = ""
        return
    cell.text = lines[0]
    for line in lines[1:]:
        paragraph = cell.add_paragraph()
        paragraph.text = line


def fill_blank(doc_path: Path) -> None:
    document = Document(doc_path)
    table = document.tables[0]

    full_name = "Хорлин Николай Владиславович"
    theme = "Разработка программного обеспечения для организации командной работы над проектами"
    specialty_group = "09.02.07 Информационные системы и программирование, 4П1-9.22"
    chapters_line = "Постановка задачи, Проектирование программного продукта, Разработка программного продукта, Экономическое обоснование."

    goal_lines = [
        "Автоматизировать процессы командной работы над проектами образовательной организации.",
        "Обеспечить единую платформу для управления задачами в формате канбан-досок, ведения репозиториев, совместной работы на визуальных досках и проведения онлайн-созвонов.",
    ]

    tasks_lines = [
        "1. Провести анализ существующих программных решений для организации командной работы и выявить их ограничения.",
        "2. Изучить бизнес-процессы управления проектами, задачами и коммуникациями в целевой организации.",
        "3. Спроектировать архитектуру программного комплекса, объединяющего веб-интерфейс, серверные компоненты и инфраструктурные сервисы.",
        "4. Спроектировать пользовательский интерфейс веб-приложения для управления канбан-досками, репозиториями и визуальными досками.",
        "5. Реализовать серверное приложение с функциями управления задачами, репозиториями, пайплайнами и учетными записями пользователей.",
        "6. Реализовать веб-клиент с поддержкой drag-and-drop канбан-досок, работы с репозиториями и совместных визуальных досок.",
        "7. Реализовать интеграцию сервисов онлайн-созвонов, уведомлений и обмена комментариями в режиме реального времени.",
        "8. Провести тестирование реализованных функций и подготовить экономическое обоснование внедрения системы.",
    ]

    intro_lines = [
        "Введение: обоснование актуальности автоматизации командной работы, формулировка цели и задач дипломного проекта.",
    ]

    chapter1_lines = [
        "Глава 1. Постановка задачи:",
        "- Анализ проблемной зоны командной работы над проектами.",
        "- Анализ предметной области и бизнес-процессов организации.",
        "- Формулирование требований к программному комплексу.",
    ]

    chapter2_lines = [
        "Глава 2. Проектирование программного продукта:",
        "- Проектирование архитектуры информационной системы Project Monitor.",
        "- Проектирование серверного приложения и API.",
        "- Проектирование веб-интерфейса и пользовательских сценариев.",
    ]

    chapter3_lines = [
        "Глава 3. Разработка программного продукта:",
        "- Реализация серверного приложения и интеграции с инфраструктурными сервисами.",
        "- Реализация веб-приложения для работы с задачами, репозиториями и визуальными досками.",
        "- Реализация механизмов онлайн-созвонов и уведомлений.",
    ]

    chapter4_lines = [
        "Глава 4. Экономическое обоснование:",
        "- Оценка экономической эффективности внедрения программного комплекса.",
        "- Расчет затрат на разработку и эксплуатацию системы.",
        "- Анализ ожидаемых выгод и сроков окупаемости.",
    ]

    conclusion_lines = [
        "Заключение: подведение итогов выполненной работы и перспективы развития системы.",
    ]

    appendix_lines = [
        "Список литературы: нормативные документы, научные публикации и электронные ресурсы.",
        "Приложения: схемы архитектуры, интерфейсы, результаты тестирования.",
        "Графические материалы: макеты экранов, диаграммы взаимодействия, схемы сервисов.",
    ]

    supervisor_signature = "А.Ю. Чернышев"
    student_signature = "Н.В. Хорлин"

    # Данные в столбцах 1-4
    for column_index in range(1, 5):
        set_cell_lines(table.cell(13, column_index), [full_name])
        set_cell_lines(table.cell(14, column_index), [theme])
        set_cell_lines(table.cell(15, column_index), [specialty_group])
        set_cell_lines(table.cell(16, column_index), [chapters_line])

        set_cell_lines(table.cell(18, column_index), goal_lines)
        set_cell_lines(table.cell(22, column_index), tasks_lines)

        set_cell_lines(table.cell(27, column_index), intro_lines + chapter1_lines + chapter2_lines + chapter3_lines + chapter4_lines + conclusion_lines + appendix_lines)

        set_cell_lines(table.cell(33, column_index), [supervisor_signature])
        set_cell_lines(table.cell(38, column_index), [student_signature])

    document.save(doc_path)


if __name__ == "__main__":
    document_path = Path("project-monitor") / "Бланк задания на ВКР.docx"
    fill_blank(document_path)
